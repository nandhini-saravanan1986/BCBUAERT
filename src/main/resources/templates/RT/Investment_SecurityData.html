<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd">

<!-- 
CREATED BY	: Rajalakshmi R
CREATED ON	: 04.06.2025
PURPOSE		: CBUAE_Investment_Securities_Data_Template_Pillar 2_
TESTED BY   : RAJALAKSHMI R
-->

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- CSS -->
	<link rel="stylesheet" type="text/css" th:href="@{/webjars/bootstrap/4.3.1/css/bootstrap.min.css}">
	<link rel="stylesheet" type="text/css" th:href="@{/webjars/font-awesome/5.9.0/css/all.min.css}">
	<link rel="stylesheet" type="text/css" th:href="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.css}">
	<link rel="stylesheet" type="text/css" th:href="@{/webjars/datatables/1.10.19/css/jquery.dataTables.min.css}">
	<link rel="stylesheet" th:href="@{/css/CustomButton.css}" />
	<link rel="icon" th:href="@{/favicon.ico}" type="image/x-icon" />

	<!-- JavaScript -->
	<!-- jQuery core (required first) -->


	<!-- ✅ Your manually placed jQuery validation
	<script th:src="@{/webjars/jquery/3.4.1/jquery.min.js}"></script>
	 <script th:src="/jquery/jquery.validate.min.js"></script>
	 -->

	<!-- jQuery (required first) -->

	<!-- jQuery core (must be loaded first) -->
	<script th:src="@{/webjars/jquery/3.4.1/jquery.min.js}"></script>

	<!-- ✅ jQuery Validation -->
	<script src="/webjars/jquery-validation/1.19.0/jquery.validate.min.js"
		th:src="@{/webjars/jquery-validation/1.19.0/jquery.validate.min.js}"></script>

	<!-- Bootstrap + Others -->
	<script th:src="@{/webjars/popper.js/1.14.7/umd/popper.min.js}"></script>
	<script th:src="@{/webjars/bootstrap/4.3.1/js/bootstrap.min.js}"></script>
	<script th:src="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.js}"></script>
	<script th:src="@{/webjars/jquery-form/4.2.2/jquery.form.min.js}"></script>
	<script th:src="@{/webjars/datatables/1.10.19/js/jquery.dataTables.min.js}"></script>
	<script th:src="@{/webjars/datatables/1.10.19/js/dataTables.bootstrap4.min.js}"></script>



	<style>
		.btns {
			float: right;
			margin: 5px;
		}

		.col-sm-5 {
			padding-bottom: 15px;
		}

		.list-body {
			padding: 0px;
		}

		.error {
			color: red;
			padding-left: 10px;
		}

		.formline {
			padding-bottom: 15px;
		}

		.btn-primary {
			background-color: #E77400;
			border-color: #0c0c0c;
		}


		.btn-primary:not(:disabled):not(.disabled).active,
		.btn-primary:not(:disabled):not(.disabled):active,
		.show>.btn-primary.dropdown-toggle {
			color: #fff;
			background-color: #cc0000;
			/* corrected to a valid red */
			border-color: #161617;
		}


		#finusertb {
			width: 460px;
		}

		.dataTables_wrapper .dataTables_paginate .paginate_button {
			padding: 0px;
		}
	</style>




	<style>
		.card {
			box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
			border-radius: 8px;
		}

		.card-header h5 {
			font-size: 22px;
			color: #fff;
			font-weight: 600;
		}

		.nav-tabs .nav-link {
			font-weight: 500;
			border: 1px solid #dee2e6;
			border-bottom: none;
			border-radius: 4px 4px 0 0;
			background-color: #f1f1f1;
			margin-right: 5px;
		}

		.nav-tabs .nav-link.active {
			background-color: #ffffff;
			border-color: #dee2e6 #dee2e6 #ffffff;
		}

		.table-responsive {
			border: 1px solid #dee2e6;
			border-radius: 4px;
		}

		.table-hover tbody tr:hover {
			background-color: #f3f6f9;
		}

		thead th {
			position: sticky;
			top: 0;
			background-color: #e9ecf0;
			z-index: 1;
		}

		.card-footer {
			padding: 10px;
			border-top: 1px solid #ccc;
		}

		.btn-xs {
			padding: 4px 12px;
			font-size: 14px;
			border-radius: 4px;
		}

		#usertable th,
		#usertable td {
			vertical-align: middle;
			text-align: left;
			font-size: 17px;
			font-family: Verdana, sans-serif;
		}

		.fa-edit:hover {
			color: #28a745;
			transform: scale(1.1);
		}



		td {
			border: 1px solid rgb(0, 164, 166);
			overflow: hidden;
			white-space: nowrap;
			text-overflow: ellipsis;
		}
	</style>


	<style>
		.form-group {
			position: relative;
			margin-bottom: 1.5rem;
		}

		.form-control {
			width: 100%;
			border: 2px solid #ccc;
			border-radius: 8px;
			font-size: 1rem;
			outline: none;
			background: transparent;
			transition: border-color 0.3s ease, padding-top 0.3s ease;
		}

		.error {
			color: red;
			padding-top: 15px;
		}



		.form-control:focus {
			border-color: #007bff;
		}

		.form-legend {
			position: absolute;
			top: 50%;
			left: 15px;
			transform: translateY(-50%);
			font-size: 1rem;
			color: #aaa;
			background: white;
			padding: 0 5px;
			pointer-events: none;
			transition: 0.3s ease;
		}

		/* When input or select is focused or has a value, move the label up */
		.form-control:focus~.form-legend,
		.form-control:not(:placeholder-shown)~.form-legend {
			top: -8px;
			font-size: 1rem;
			color: #007bff;
		}

		/* Hover effect when the input/select is focused */
		.form-control:focus:hover~.form-legend {
			color: #0056b3;
			/* Darker shade of blue on hover */
		}

		/* Ensure the label returns to the normal color after focus or hover is removed */
		.form-control:not(:focus)~.form-legend {
			color: #aaa;
			/* Normal label color */
		}
	</style>

	<style>
		/* Red border for invalid inputs */
		input.error,
		select.error {
			border: 2px solid red !important;
		}

		/* Error message style */
		label.error {
			color: red;
			font-size: 0.85em;
			margin-top: 5px;
			display: block;
		}
	</style>
	<script>
		$(document).ready(function () {
			$("#nostroForm").validate({
				errorClass: "error", // use 'error' class for styling
				errorElement: "label", // wrap error messages in <label>

				// Place the error after the input field
				errorPlacement: function (error, element) {
					if (element.parent('.form-group').length) {
						error.insertAfter(element); // default
					} else {
						error.insertAfter(element);
					}
				},

				// Highlight and unhighlight fields
				highlight: function (element) {
					$(element).addClass("error");
				},
				unhighlight: function (element) {
					$(element).removeClass("error");
				},

				// On successful validation, run this
				submitHandler: function (form) {
					submitForm(); // your custom submit function
				}
			});
		});
	</script>

	<script>

		function submitForm() {
			$("#loader").modal("toggle");

			const reportName = 'CBUAE_Investment_Securities_Data_Template	';
			const submitUrl = './createDataControl?report_name=' + encodeURIComponent(reportName);
			const formData = $("#nostroForm").serialize();

			$.ajax({
				url: submitUrl,
				type: "POST",
				data: formData,
				success: function (response) {
					$("#loader").modal("hide");

					$("#alertmsg1").text(response);
					$("#alert1").modal("toggle");
					//location.href = 'Nostro_Account_Bal';
				},
				error: function (xhr, status, error) {
					$("#loader").modal("hide");

					console.error("Error:", error);
					alert("Error occurred: " + error);
				}
			});
		}


	</script>

	<script th:inline="javascript">


		function home() {
			$("#loader").modal("toggle");
			location.href = 'Dashboard'
		}

		function back() {
			$("#loader").modal("toggle");

			window.history.back();
		}

		function list() {
			location.href = 'Investment_Securities_Data?formmode=list';
		}

		function nostro() {
			location.href = 'Investment_Securities_Data';
		}
		$(document).ready(function () {
			// On modal close, redirect to your controller method path
			$('#alert').on('hidden.bs.modal', function () {
				window.location.href = './Investment_Securities_Data';
			});
		});

		function updateform(event) {

			event.preventDefault();
			$("#loader").modal("toggle");

			$.ajax({
				url: `./updateInvestmentSecurity`,
				type: 'POST',
				data: $('#InvestmentData').serialize(),
				success: function (response) {
					$("#loader").modal("hide");


					$("#alertmsg").text(response);
					$("#alert").modal("toggle");

				},
				error: function (xhr, status, error) {
					console.error("Error in modify:", error);
					$("#loader").modal("hide");

					alert("Failed to modify. Please try again.");
				}
			});

		}

	</script>

</head>


<script>
	function navigateToTab(tabId) {
		$("#loader").modal("show");

		if (tabId === 'data') {
			window.location.href = 'Investment_Securities_Data?formmode=list';
		} else if (tabId === 'datacontrols') {
			window.location.href = 'Investment_Securities_Data?formmode=add';
		}
	}


	function handleClick(tabId) {
		// Remove active class from all buttons
		document.querySelectorAll('.custom-tab-btn').forEach(btn => btn.classList.remove('active'));
		document.getElementById(tabId + '-btn').classList.add('active');

		// Hide all panes
		document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('show', 'active'));
		document.getElementById(tabId).classList.add('show', 'active');
	}

	// On page load, detect formmode and show corresponding tab
	window.addEventListener('DOMContentLoaded', function () {
		const params = new URLSearchParams(window.location.search);
		const formmode = params.get('formmode');

		if (formmode === 'list') {
			handleClick('data');
		} else {
			handleClick('datacontrols'); // default or formmode=add
		}
	});
</script>




<script>
	function downloadInvestmentSecurities() {
		$('#loader').modal('show');

		$.ajax({
			url: './downloadInvestmentSecuritiesExcel', // This URL must match your controller endpoint
			type: 'GET',
			xhrFields: {
				responseType: 'blob' // Essential for handling binary file data
			},
			success: function (data, textStatus, jqXHR) {
				$('#loader').modal('hide');

				// Check for a "No Content" response from the server
				if (jqXHR.status === 204 || !data || data.size < 100) {
					showResultModal('Information', 'No data was available to create the report.');
					return;
				}

				const blob = new Blob([data], {type: 'application/vnd.ms-excel'});
				const url = window.URL.createObjectURL(blob);
				const a = document.createElement('a');

				a.style.display = 'none';
				a.href = url;
				a.download = 'CBUAE_Investment_Securities_Data_Template_Pillar2.xls'; // The filename for the user

				document.body.appendChild(a);
				a.click();

				// Clean up the temporary URL and link
				window.URL.revokeObjectURL(url);
				document.body.removeChild(a);

				showResultModal('Success', 'The CBUAE_Investment_Securities_Data_Template_Pillar2 file has been downloaded successfully.');

			},
			error: function (jqXHR, textStatus, errorThrown) {
				$('#loader').modal('hide');
				console.error("Download failed:", textStatus, errorThrown);
				showResultModal('Error', 'An error occurred while downloading the file. Please check server logs and try again.');
			}
		});
	}

	function showResultModal(title, message) {
		$('#resultModalLabel').text(title);
		$('#resultModalBody').text(message);
		$('#resultModal').modal('show');
	}
</script>

<title>BCDRS</title>

<body>
	<div class="container-fluid" style="padding-left:0px; padding-right:0px;">
		<div class="row">

			<div th:insert="XBRLHeaderMenu :: header"></div>

			<div class="card-header" th:if="${formmode == 'list' or formmode == 'add' or formmode =='null' }"
				style="background-color: rgb(107, 122, 143) ; ">
				<div class="float-left">
					<h5
						style="font-family: verdana; margin-left:20px; font-size: 20px; font-weight: bold; padding-top: 10px; ">
						INVESTMENT SECURITIES DATA</h5>
				</div>


			</div>
			<!-- -------------------User List Starts----------------------------------------------------- -->
			<div style="padding-right: 10px;padding-left: 20px;"
				th:if="${formmode == 'list' or formmode == 'add' or formmode =='null' }">





				<!-- Tabs -->
				<div class="button-tab-group" style="margin-top:5px; margin-bottom:20px;">
					<button class="custom-tab-btn" id="datacontrols-btn" onclick="navigateToTab('datacontrols')">Data
						Controls</button>
					<button class="custom-tab-btn" id="template-btn" onclick="handleClick('template')">Template
						Instructions</button>
					<button class="custom-tab-btn" id="data-btn" onclick="navigateToTab('data')">Data</button>
					<div class="float-right" style="margin-left:61%">
						<button th:if="${formmode} =='list'" type="button" class="custom-tab-btn"
							onclick="downloadInvestmentSecurities();">
							<i class="fa fa-download"></i> Download
						</button>



					</div>
				</div>


				<div class="tab-content" id="myTabContent" style="margin-top: 15px;"
					th:if="${formmode == null or formmode == 'add'}">
					<div class="tab-pane fade show active" id="datacontrols" role="tabpanel">

						<div class="row">
							<div class="col-sm-12 finuserapply">
								<form id="nostroForm" method="post" autocomplete="off">
									<div class="card-body" style="max-height:450px; overflow-y:auto">


										<input autocomplete="false" name="hidden" type="text" style="display: none;">
										<div class="form-group" style="border:none">
											<div class="row formline">
												<div class="col-sm-1"></div>
												<div class="form-group col-md-4">
													<select id="submittingInstitution" name="submittingInstitution"
														class="form-control" required>
														<option value="">-- Select Institution --</option>
														<option value="Bank of Baroda">Bank of Baroda</option>
													</select>
													<label for="submittingInstitution" class="form-legend">Submitting
														Institution</label>
												</div>


												<div class="col-sm-1"></div>

												<div class="form-group col-md-4">
													<input type="date" id="portfolioDate" name="portfolioDate"
														class="form-control" placeholder=" " required />
													<label for="portfolioDate" class="form-legend">Portfolio
														date</label>
												</div>
											</div>

											<!-- Contact Employee 1 Name / Title -->
											<!-- Contact Employee 1 Group -->
											<div class="form-group"
												style="border: 1px solid #e0e0e0; padding: 15px; margin-bottom: 20px; border-radius: 5px;">
												<div class="row formline">
													<div class="col-sm-12">
														<label style="font-weight: bold; color: #007B8A;">Contact
															Details(Employee 1)</label>
													</div>
												</div>
												<div class="row formline">
													<div class="form-group col-md-4">
														<input type="text" id="contactEmployee1Name1"
															name="contactEmployee1Name1" class="form-control"
															placeholder=" " required />
														<label for="contactEmployee1Name1"
															class="form-legend">Name</label>
													</div>


													<div class="form-group col-md-4">
														<input type="text" id="contactEmployee1Title1"
															name="contactEmployee1Title1" class="form-control"
															placeholder=" " required />
														<label for="contactEmployee1Title1"
															class="form-legend">Title</label>
													</div>



													<div class="form-group col-md-4">
														<input type="email" id="contactEmployee1Email1"
															name="contactEmployee1Email1" class="form-control"
															placeholder=" " required />
														<label for="contactEmployee1Email1"
															class="form-legend">Email</label>
													</div>
													<div class="col-sm-3">
													</div>

												</div>
											</div>
											<div class="form-group"
												style="border: 1px solid #e0e0e0; padding: 15px; margin-bottom: 20px; border-radius: 5px;">
												<div class="row formline">
													<div class="col-sm-12">
														<label style="font-weight: bold; color: #007B8A;">Contact
															Details(Employee 2)</label>
													</div>
												</div>
												<div class="row formline">
													<div class="form-group col-md-4">
														<input type="text" id="contactEmployee2Name2"
															name="contactEmployee2Name2" class="form-control"
															placeholder=" " required />
														<label for="contactEmployee2Name2"
															class="form-legend">Name</label>
													</div>


													<div class="form-group col-md-4">
														<input type="text" id="contactEmployee2Title2"
															name="contactEmployee2Title2" class="form-control"
															placeholder=" " required />
														<label for="contactEmployee2Title2"
															class="form-legend">Title</label>
													</div>



													<div class="form-group col-md-4">
														<input type="email" id="contactEmployee2Email2"
															name="contactEmployee2Email2" class="form-control"
															placeholder=" " required />
														<label for="contactEmployee2Email2"
															class="form-legend">Email</label>
													</div>
													<div class="col-sm-3">
													</div>

												</div>
												<!-- Contact Employee 2 Group -->
											</div>
											<div class="form-group"
												style="border: 1px solid #e0e0e0; padding: 15px; margin-bottom: 20px; border-radius: 5px;">
												<div class="row formline">
													<div class="col-sm-12">
														<label style="font-weight: bold; color: #007B8A;">Sign
															Off</label>
													</div>
												</div>

												<!-- Sign-off CRO Name / Email -->
												<div class="row formline">
													<div class="col-sm-1"></div>
													<div class="form-group col-md-4">
														<input type="text" id="signOffCroName" name="signOffCroName"
															class="form-control" placeholder=" " required />
														<label for="signOffCroName" class="form-legend">CRO Name</label>
													</div>
													<div class="col-sm-1"></div>
													<div class="form-group col-md-4">
														<input type="email" id="signOffCroEmail" name="signOffCroEmail"
															class="form-control" placeholder=" " required />
														<label for="signOffCroEmail" class="form-legend">CRO
															Email</label>
													</div>

												</div>

												<!-- Sign-off CFO Name / Email -->
												<div class="row formline">
													<div class="col-sm-1"></div>
													<div class="form-group col-md-4">
														<input type="text" id="signOffCfoName" name="signOffCfoName"
															class="form-control" placeholder=" " required />
														<label for="signOffCfoName" class="form-legend">CFO Name</label>
													</div>

													<div class="col-sm-1"></div>
													<div class="form-group col-md-4">
														<input type="email" id="signOffCfoEmail" name="signOffCfoEmail"
															class="form-control" placeholder=" " required />
														<label for="signOffCfoEmail" class="form-legend">CFO
															Email</label>
													</div>

												</div>

												<!-- Sign-off Head of Treasury Name / Email -->
												<div class="row formline">
													<div class="col-sm-1"></div>
													<div class="form-group col-md-4">
														<input type="text" id="signOffHeadOfTreasuryName"
															name="signOffHeadOfTreasuryName" class="form-control"
															placeholder=" " required />
														<label for="signOffHeadOfTreasuryName" class="form-legend">Head
															of Treasury Name</label>
													</div>

													<div class="col-sm-1"></div>
													<div class="form-group col-md-4">
														<input type="email" id="signOffHeadOfTreasuryEmail"
															name="signOffHeadOfTreasuryEmail" class="form-control"
															placeholder=" " required />
														<label for="signOffHeadOfTreasuryEmail" class="form-legend">Head
															of Treasury Email</label>
													</div>
												</div>
											</div>

										</div>


								</form>
							</div>
						</div>
						<div class="card-footer text-center"
							style="background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(8px); padding: 10px; border-top: 2px solid #ccc;">
							<button type="button" class="custom-tab-btn" onclick="home();">
								<i class="fa fa-home"></i> Home
							</button>


							<!--<button th:if="${formmode == 'null' or formmode == 'add'}"  type="button" class="custom-tab-btn"
                  onclick="submitForm()">Save</button>-->

							<button th:if="${formmode == null or formmode == 'add'}" type="button"
								class="custom-tab-btn" onclick="submitForm()">Save</button>



							<button type="button" class="custom-tab-btn" onclick="back();">
								<i class="fa fa-arrow-left"></i> Back
							</button>

						</div>
					</div>
				</div>

				<!-- --------------------------------------DATA CONTROL ENDS--------------------------------------------- -->

				<!-- --------------------------------------TEMPLATE STARTS--------------------------------------------- -->

				<div class="tab-pane fade" id="template" role="tabpanel"
					th:if="${formmode == null or formmode == 'add'}">
					<p>Templates tabs</p>

					<div class="card-footer text-center"
						style="background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(8px); padding: 10px; border-top: 2px solid #ccc;">
						<button type="button" class="custom-tab-btn" onclick="home();">
							<i class="fa fa-home"></i> Home
						</button>

						<button type="button" class="custom-tab-btn" onclick="submitForm()">
							Save
						</button>

						<button type="button" class="custom-tab-btn" onclick="back();">
							<i class="fa fa-arrow-left"></i> Back
						</button>
					</div>
				</div>


				<!-- --------------------------------------TEMPLATE ENDS--------------------------------------------- -->



				<!-- -----------------------------------DATA LIST STARTS -------------------------------------------- -->
				<div class="tab-pane fade" id="data" role="tabpanel">
					<div class="table-responsive" style="max-height: 500px; overflow: auto; border:none;">
						<table id="usertable" class="table table-bordered table-striped table-hover"
							style="min-width: 2000px; font-family:calibri;">

							<thead class="thead-light" style="background-color:#e9ecf0; font-size: 11px;">
								<tr>
									<th rowspan="2">Action</th>
									<th colspan="8" style="text-align:center;">Financial Institution Information</th>
									<th colspan="9"></th>
									<!--<th colspan="6">Counterparty Information</th>-->
									<th colspan="6" style="text-align:center;">Counterparty Information</th>
									<th colspan="16" style="text-align:center;">Fixed Income Information</th>
									<th colspan="15" style="text-align:center;">Other Security Information</th>
									<th colspan="5" style="text-align:center;">Overall Portfolio Information</th>

									<th colspan="7" style="text-align:center;">Collateralization information</th>
									<th colspan="6" style="text-align:center;">IFRS Provision information (where
										applicable)</th>
								</tr>
								<tr>
									<!-- Financial Institution Information -->
									<th>Data Date</th>
									<th>Bank Name</th>
									<th>Head Office/Subsidiary</th>
									<th>Subsidiary</th>
									<th>Bank Symbol</th>
									<th>Conventional/Islamic</th>

									<!-- Counterparty Information -->
									<th>Local/Foreign</th>
									<th>CBUAE Tiering</th>
									<th>Accounting Classification</th>
									<th>Instrument Type</th>
									<th>Instrument Subcategory Type</th>
									<th>ISIN Code</th>
									<th>Bank Internal Portfolio Code</th>
									<th>CBUAE Security ID</th>
									<th>CBUAE Access Primary Key</th>

									<!-- Collateralization Information -->
									<th>Security Description</th>
									<th>Asset Currency</th>
									<th>Obligor</th>
									<th>Country of Risk</th>
									<th>CBUAE Geographical Zone</th>
									<th>Industry</th>
									<th>Sector</th>

									<!-- Fixed Income Information -->
									<th>Issuer Type</th>
									<th>Issue Size</th>
									<th>% Issue Size</th>
									<th>Nominal Trade Currency</th>
									<th>Nominal AED Equivalent</th>
									<th>Premium/DISC AED Equivalent</th>
									<th>Specific Provision AED Equivalent</th>
									<th>Net Book Price</th>
									<th>Net Book Value AED Equivalent</th>
									<th>Purchase Yield to Maturity</th>
									<th>Clean Price</th>
									<th>Clean Market Value AED Equivalent</th>

									<!-- Other Security Information -->
									<th>Current Yield to Maturity</th>
									<th>Unrealized Gain/Loss AED Equivalent</th>
									<th>Subordinated Debt/Sukuk</th>
									<th>Final Rating (Banks)</th>
									<th>Final Rating (CBUAE)</th>
									<th>Credit Quality</th>
									<th>Maturity Date/Callable Date</th>
									<th>Residual Maturity</th>
									<th>Maturity Period</th>
									<th>% Holdings FI</th>
									<th>Qty (Equity/Funds)</th>
									<th>Equity Floating / Fund Total Assets</th>
									<th>% Total Floating Share/ % Fund AUM</th>
									<th>Specific Provision (AED equivalent)</th>
									<th>Net Book Value (AED equivalent))</th>
									<th>Net Book Price</th>
									<th>Market Price</th>
									<th>Fair Value Amount AED</th>
									<th>Unrealized Gai/Loss (AED)</th>
									<th>% Holdings (Other)</th>
									<th>Total Net Book Value AED</th>
									<th>Total Market Value AED</th>
									<th>Total Unrealized Gain/Loss</th>
									<th>Unrealized Gain/Loss Contribution</th>
									<th>% Holdings</th>

									<!-- Overall Portfolio Information -->
									<th>Existing Pledge Status</th>
									<th>Pledged Amount (AED equivalent)</th>
									<th>Unencumbered Amount (AED equivalent)</th>
									<th>Proportion of Unencumbered Security</th>
									<th>HQLA/ELAR eligibility</th>

									<!-- IFRS Provision Information -->
									<th>Liquidity type, if applicable</th>
									<th>Sukuk Type</th>
									<th>TTC PD</th>
									<th>PIT PD</th>
									<th>ECL 1Y</th>
									<th>ECL Lifetime</th>
									<th>ECL Final</th>
									<th>IFRS9 Staging</th>

								</tr>
							</thead>
							<!--<tbody style="font-size: 9px;">
								<tr th:each="data : ${ISList}">
									<td>
										<a
											th:href="@{'/Investment_Securities_Data?formmode=edit&siNo=' + ${data.siNo}}">
											<i class="fa fa-edit" style="color: #007bff;"></i>
										</a>
									</td>-->
							<tbody style="font-size: 9px;" th:each="data : ${ISList}">
								<tr>
									<td><a
											th:href="@{'/Investment_Securities_Data?formmode=edit&siNo=' + ${data.siNo}}">
											<i class="fa fa-edit" style="color: #007bff;"></i></a>
									</td>
									<td th:text="${#dates.format(data.dataDate, 'dd-MM-yyyy')}"></td>
									<td th:text="${data.bankName}"></td>
									<td th:text="${data.headOfficeSubsidiary}"></td>
									<td th:text="${data.subsidiary}"></td>
									<td th:text="${data.bankSymbol}"></td>
									<td th:text="${data.conventionalIslamic}"></td>

									<td th:text="${data.localForeign}"></td>
									<td th:text="${data.cbuAeTiering}"></td>
									<td th:text="${data.accountingClassification}"></td>
									<td th:text="${data.instrumentType}"></td>
									<td th:text="${data.instrumentSubcategoryType}"></td>
									<td th:text="${data.isinCode}"></td>
									<td th:text="${data.bankInternalPortfolioCode}"></td>
									<td th:text="${data.cbuAeSecurityId}"></td>
									<td th:text="${data.cbuAeAccessPrimaryKey}"></td>

									<td th:text="${data.securityDescription}"></td>
									<td th:text="${data.assetCurrency}"></td>
									<td th:text="${data.obligor}"></td>
									<td th:text="${data.countryOfRisk}"></td>
									<td th:text="${data.cbuAeGeographicalZone}"></td>
									<td th:text="${data.industry}"></td>
									<td th:text="${data.sector}"></td>

									<td th:text="${data.issuerType}"></td>
									<td th:text="${#numbers.formatDecimal(data.issueSize, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.percentIssueSize, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.nominalTradeCurrency, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.nominalAedEquivalent, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.premDiscAedEquivalent, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.specificProvisionAed, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.fixedIncomeInfoNetBookPrice, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.netBookValueAed, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.purchaseYieldToMaturity, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td th:text="${#numbers.formatDecimal(data.cleanPrice, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.cleanMarketValueAed, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.currentYieldToMaturity, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.unrealizedGainLossAed, 1, 'COMMA', 2, 'POINT')}">
									</td>

									<!-- subDebtSukuk is String -->
									<td th:text="${data.subordinatedDebtSukuk}"></td>

									<td th:text="${data.finalRatingBanks}"></td>
									<td th:text="${data.finalRatingCbuae}"></td>
									<td th:text="${data.creditQuality}"></td>
									<td th:text="${#dates.format(data.maturityDate, 'dd-MM-yyyy')}"></td>
									<td th:text="${data.residualMaturity}"></td>
									<td th:text="${data.maturityPeriod}"></td>

									<td
										th:text="${#numbers.formatDecimal(data.percentHoldingsFi, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.qtyEquityFunds, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.equityFloatingFundAssets, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.totalFloatingShareFundAum, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.specificProvision, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td th:text="${#numbers.formatDecimal(data.netBookValue, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.otherSecInfoNetBookPrice, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td th:text="${#numbers.formatDecimal(data.marketPrice, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.fairValueAmountAed, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.unrealizedGainLossAgain, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.percentHoldingsOther, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.totalNetBookValueAed, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.totalMarketValueAed, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.totalUnrealizedGainLoss, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.unrealizedGainLossContrib, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.percentHoldings, 1, 'COMMA', 2, 'POINT')}">
									</td>

									<!-- existingPledgeStatus and others -->
									<td th:text="${data.existingPledgeStatus}"></td>
									<td
										th:text="${#numbers.formatDecimal(data.pledgedAmountAed, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.unencumberedAmountAed, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td
										th:text="${#numbers.formatDecimal(data.proportionUnencumbered, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td th:text="${data.hqlaElarEligibility}"></td>
									<td th:text="${data.liquidityType}"></td>
									<td th:text="${data.sukukType}"></td>
									<td th:text="${#numbers.formatDecimal(data.ttcPd, 1, 'COMMA', 2, 'POINT')}"></td>
									<td th:text="${#numbers.formatDecimal(data.pitPd, 1, 'COMMA', 2, 'POINT')}"></td>
									<td th:text="${#numbers.formatDecimal(data.ecl1y, 1, 'COMMA', 2, 'POINT')}"></td>
									<td th:text="${#numbers.formatDecimal(data.eclLifetime, 1, 'COMMA', 2, 'POINT')}">
									</td>
									<td th:text="${#numbers.formatDecimal(data.eclFinal, 1, 'COMMA', 2, 'POINT')}"></td>
									<td th:text="${data.ifrs9Staging}"></td>
									
								</tr>
							</tbody>
						</table>
					</div>


					<div class="card-footer text-center"
						style="background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(8px); padding: 10px; border-top: 2px solid #ccc;">
						<button type="button" class="custom-tab-btn" onclick="home();">
							<i class="fa fa-home"></i> Home
						</button>


						<button th:if="${formmode == 'null' or formmode == 'add'}" type="button" class="custom-tab-btn"
							onclick="submitForm()">Save</button>


						<button type="button" class="custom-tab-btn" onclick="back();">
							<i class="fa fa-arrow-left"></i> Back
						</button>

					</div>

				</div>

			</div>

			<!-- ---------------- edit starts------------------------------------------------------------ -->



			<!--<div th:if="${formmode}=='edit'" style="align-items:center">
				<form th:action="@{/updateInvestmentSecurity}" th:object="${InvestmentData}" method="post"
					id="InvestmentData">
					<div class="card" style="margin: 0 15px;">-->

			<!-- Card Header -->


			<div th:if="${formmode}=='edit'" style="align-items:center">
				<form th:action="@{/updateInvestmentSecurity}" th:object="${InvestmentData}" method="post"
					id="InvestmentData">
					<div class="card" style="margin: 0 15px;">
						<div class="card-header" style="background-color: rgb(107, 122, 143);">
							<h5 class="m-0 font-weight-bold"
								style="font-family: verdana; margin-left: 20px; font-size: 20px; font-weight: bold; padding-top: 10px;">
								INVESTMENT SECURITIES DATA - EDIT
							</h5>
						</div>

						<div class="card-body" style="max-height: 500px; overflow-y: auto;">
							<input type="hidden" th:field="*{siNo}" />

							<h4 class="section-header">Financial Institution Information</h4>
							<!-- Bank Info -->
							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Data Date</label>
								<div class="col-sm-4">
									<input type="date" class="form-control" th:field="*{dataDate}" required readonly />
								</div>

								<label class="col-sm-2 col-form-label">Bank Name</label>
								<div class="col-sm-4">
									<select class="form-control" th:field="*{bankName}"
										onchange="handleBankChange(this)">
										<option value="" disabled selected>-- Select Bank --</option>
										<option th:each="bank : ${bankList}" th:value="${bank.bankName}"
											th:text="${bank.bankName}"></option>
									</select>
								</div>
							</div>

							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Head Office/Subsidiary</label>
								<div class="col-sm-4">
									<select class="form-control" th:field="*{headOfficeSubsidiary}">
										<option value="" disabled selected>-- Select --</option>
										<option value="Head Office">Head Office</option>
										<option value="Subsidiary">Subsidiary</option>
									</select>
								</div>
								<label class="col-sm-2 col-form-label">Subsidiary</label>
								<div class="col-sm-4">
									<input type="text" class="form-control vchar-50" th:field="*{subsidiary}" />
								</div>
							</div>

							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Bank Symbol</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" th:field="*{bankSymbol}" id="bankSymbol"
										readonly />
								</div>
								<label class="col-sm-2 col-form-label">Conventional/Islamic</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" th:field="*{conventionalIslamic}"
										id="conventionalIslamic" readonly />
								</div>
							</div>

							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Local/Foreign</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" th:field="*{localForeign}" id="localForeign"
										readonly />
								</div>
								<label class="col-sm-2 col-form-label">CBUAE Tiering</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" th:field="*{cbuAeTiering}" id="cbuAeTiering"
										readonly />
								</div>
							</div>
							<h4 class="section-header">Accounts Information</h4>

							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Accounting Classification</label>
								<div class="col-sm-4">
									<select class="form-control" th:field="*{accountingClassification}">
										<option value="" disabled selected>-- Select --</option>
										<option value="FVT PL">FVT PL</option>
										<option value="FVTOCI">FVTOCI</option>
										<option value="Amortized Cost">Amortized Cost</option>
									</select>

								</div>

								<label class="col-sm-2 col-form-label">Instrument Type</label>
								<div class="col-sm-4">
									<select class="form-control" th:field="*{instrumentType}">
										<option value="" disabled selected>-- Select --</option>
										<option value="Bond">Bond</option>
										<option value="Sukuk">Sukuk</option>
										<option value="Private Placement">Private Placement</option>
										<option value="Equity">Equity</option>
										<option value="Credit">Credit</option>
										<option value="Active Fund ">Active Fund</option>
										<option value="Passive Fund">Passive Fund</option>
										<option value="ETF">ETF</option>
										<option value="Other">Other</option>
									</select>
								</div>
							</div>

							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Instrument Subcategory Type</label>
								<div class="col-sm-4">
									<select class="form-control" th:field="*{instrumentSubcategoryType}">
										<option value="" disabled selected>-- Select --</option>
										<option value="Equity">Equity</option>
										<option value="Fixed Income">Fixed Income</option>
										<option value="Money Market">Money Market</option>
										<option value="Diversified">Diversified</option>
										<option value="Hedge Fund">Hedge Fund</option>
										<option value="Commodities">Commodities</option>
										<option value="Real Estate">Real Estate</option>
										<option value="Private Placement">Private Placement</option>
										<option value="Other">Other</option>
									</select>
								</div>

								<label class="col-sm-2 col-form-label">ISIN Code</label>
								<div class="col-sm-4">
									<input type="text" class="form-control vchar-50" th:field="*{isinCode}" />
								</div>
							</div>

							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Bank Internal Portfolio Code</label>
								<div class="col-sm-4">
									<input type="text" class="form-control vchar-50" th:field="*{bankInternalPortfolioCode}" />
								</div>

								<label class="col-sm-2 col-form-label">CBUAE Security ID</label>
								<div class="col-sm-4">
									<input type="text" class="form-control vchar-50" th:field="*{cbuAeSecurityId}" />
								</div>
							</div>

							<div class="form-group row">
								<label class="col-sm-2 col-form-label">CBUAE Access Primary Key</label>
								<div class="col-sm-4">
									<input type="text" class="form-control vchar-50" th:field="*{cbuAeAccessPrimaryKey}" />
								</div>

								<label class="col-sm-2 col-form-label vchar-50">Security Description</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" th:field="*{securityDescription}" />
								</div>
							</div>

							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Asset Currency</label>
								<div class="col-sm-4">
									<input type="text" class="form-control vchar-10" th:field="*{assetCurrency}" />
								</div>
							</div>
							<h4 class="section-header">Counterparty Information</h4>
							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Obligor</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" th:field="*{obligor}" />
								</div>
								<label class="col-sm-2 col-form-label">Country of Risk</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" th:field="*{countryOfRisk}" />
								</div>
							</div>

							<div class="form-group row">


								<label class="col-sm-2 col-form-label">CBUAE Geographical Zone</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" th:field="*{cbuAeGeographicalZone}" />
								</div>
								<label class="col-sm-2 col-form-label">Industry</label>
								<div class="col-sm-4">
									<input type="text" class="form-control vchar-50" th:field="*{industry}" />
								</div>
							</div>

							<div class="form-group row">


								<label class="col-sm-2 col-form-label">Sector</label>
								<div class="col-sm-4">
									<input type="text" class="form-control vchar-50" th:field="*{sector}" />
								</div>
								<label class="col-sm-2 col-form-label">Issuer Type</label>
								<div class="col-sm-4">
									<select class="form-control" th:field="*{issuerType}">
										<option value="" disabled selected>-- Select --</option>
										<option value="Sovereign">Sovereign</option>
										<option value="Corporate">Corporate</option>
										<option value="FI">FI</option>
										<option value="Other">Other</option>
									</select>

								</div>
							</div>


							<h4 class="section-header">Fixed Income Information</h4>
							<!-- Other -->
							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Issue Size</label>
								<div class="col-sm-4"><input type="number" class="form-control number-24-2" th:field="*{issueSize}" />
								</div>

								<label class="col-sm-2 col-form-label">Percent Issue Size</label>
								<div class="col-sm-4"><input type="number" class="form-control number-24-2"
										th:field="*{percentIssueSize}" /></div>
							</div>

							<!-- Nostro -->
							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Nominal Trade Currency</label>
								<div class="col-sm-4"><input type="number" class="form-control number-24-2"
										th:field="*{nominalTradeCurrency}" /></div>

								<label class="col-sm-2 col-form-label">Nominal AED Equivalent</label>
								<div class="col-sm-4"><input type="number" class="form-control number-24-2"
										th:field="*{nominalAedEquivalent}" /></div>
							</div>

							<!-- Derivatives -->
							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Prem Disc AED Equivalent</label>
								<div class="col-sm-4"><input type="number" class="form-control number-24-2"
										th:field="*{premDiscAedEquivalent}" /></div>

								<label class="col-sm-2 col-form-label">Specific Provision AED</label>
								<div class="col-sm-4"><input type="number" class="form-control number-24-2"
										th:field="*{specificProvisionAed}" /></div>
							</div>

							<!-- FX -->
							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Net Book Price</label>
								<div class="col-sm-4"><input type="number" class="form-control number-24-2"
										th:field="*{fixedIncomeInfoNetBookPrice}" /></div>

								<label class="col-sm-2 col-form-label">Net Book Value AED</label>
								<div class="col-sm-4"><input type="number" class="form-control number-24-2"
										th:field="*{netBookValueAed}" /></div>
							</div>

							<!-- Bond Settlement -->
							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Purchase Yeild to Maturity</label>
								<div class="col-sm-4"><input type="text" class="form-control number-24-2"
										th:field="*{purchaseYieldToMaturity}" /></div>

								<label class="col-sm-2 col-form-label">Clean Price</label>
								<div class="col-sm-4"><input type="number" class="form-control number-24-2"
										th:field="*{cleanPrice}" /></div>
							</div>

							<!-- Overall Treasury -->
							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Clean Market Value AED</label>
								<div class="col-sm-4"><input type="number" class="form-control number-24-2"
										th:field="*{cleanMarketValueAed}" /></div>

								<label class="col-sm-2 col-form-label">Current Yeild to Maturity</label>
								<div class="col-sm-4"><input type="number" class="form-control number-24-2"
										th:field="*{currentYieldToMaturity}" /></div>
							</div>

							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Unrealized Gain/Loss AED</label>
								<div class="col-sm-4"><input type="number" class="form-control number-24-2"
										th:field="*{unrealizedGainLossAed}" /></div>

								<label class="col-sm-2 col-form-label">Subordinated Debt/Sukuk</label>
								<div class="col-sm-4">
									<select class="form-control" th:field="*{subordinatedDebtSukuk}">
										<option value="" disabled selected>-- Select --</option>
										<option value="Y">Y</option>
									</select>
								</div>
							</div>

							<!-- Derivatives -->
							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Final Rating Banks</label>
								<div class="col-sm-4">
									<input type="text" class="form-control vchar-20" th:field="*{finalRatingBanks}" />
								</div>

								<label class="col-sm-2 col-form-label">Final Rating CBUAE</label>
								<div class="col-sm-4">
									<input type="text" class="form-control vchar-20" th:field="*{finalRatingCbuae}" />
								</div>
							</div>


							<!-- FX -->
							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Credit Quality</label>
								<div class="col-sm-4">
									<input type="text" class="form-control vchar-50" th:field="*{creditQuality}" />
								</div>

								<label class="col-sm-2 col-form-label">Maturity Date</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" th:field="*{maturityDate}" />
								</div>
							</div>

							<!-- Bond Settlement -->
							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Residual Maturity</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{residualMaturity}" />
								</div>

								<label class="col-sm-2 col-form-label">Maturity Period</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{maturityPeriod}" />
								</div>
							</div>

							<!-- Overall Treasury -->
							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Percent Holdings FI</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{percentHoldingsFi}" />
								</div>
							</div>

							<h4 class="section-header">Other Security Information</h4>
							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Qty (Equity/Funds)</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{qtyEquityFunds}" />
								</div>
								<label class="col-sm-2 col-form-label">Equity Floating Fund Assets</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{equityFloatingFundAssets}" />
								</div>
							</div>

							<div class="form-group row">


								<label class="col-sm-2 col-form-label">Total Floating Share FundAum</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{totalFloatingShareFundAum}" />
								</div>
								<label class="col-sm-2 col-form-label">Specific Provision</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{specificProvision}" />
								</div>

							</div>

							<div class="form-group row">

								<label class="col-sm-2 col-form-label">Net Book Value</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{netBookValue}" />
								</div>
								<label class="col-sm-2 col-form-label">Net Book Price</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{otherSecInfoNetBookPrice}" />
								</div>
							</div>

							<!-- FX -->
							<div class="form-group row">

								<label class="col-sm-2 col-form-label">Market Price</label>
								<div class="col-sm-4">
									<input type="number"  step="0.01" class="form-control number-24-2" th:field="*{marketPrice}" />
								</div>
								<label class="col-sm-2 col-form-label">Fair Value Amount AED</label>
								<div class="col-sm-4">
									<input type="number" step="0.01" class="form-control number-24-2" th:field="*{fairValueAmountAed}" />
								</div>
							</div>

							<!-- Bond Settlement -->
							<div class="form-group row">


								<label class="col-sm-2 col-form-label">UnrealizedGainLoss Again</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{unrealizedGainLossAgain}" />
								</div>
								<label class="col-sm-2 col-form-label">Percent Holdings Other</label>
								<div class="col-sm-4">
									<input type="number" step="0.01" class="form-control number-24-2" th:field="*{percentHoldingsOther}" />
								</div>
							</div>

							<!-- Overall Treasury -->

							<h4 class="section-header">Overall Portfolio Information</h4>
							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Total NetBook ValueAED</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{totalNetBookValueAed}" />
								</div>
								<label class="col-sm-2 col-form-label">Total Market Value AED</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{totalMarketValueAed}" />
								</div>
							</div>

							<div class="form-group row">


								<label class="col-sm-2 col-form-label">Total Unrealized GainLoss</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{totalUnrealizedGainLoss}" />
								</div>
								<label class="col-sm-2 col-form-label">Unrealized GainLoss Contrib</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{unrealizedGainLossContrib}" />
								</div>
							</div>

							<div class="form-group row">


								<label class="col-sm-2 col-form-label">Percent Holdings</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{percentHoldings}" />
								</div>
							</div>

							<h4 class="section-header">Collateralization information</h4>

							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Existing PledgeStatus</label>
								<div class="col-sm-4">
									<input type="text" class="form-control vchar-20" th:field="*{existingPledgeStatus}" />
								</div>

								<label class="col-sm-2 col-form-label">Pledged Amount AED</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{pledgedAmountAed}" />
								</div>
							</div>

							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Unencumbered AmountAed</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{unencumberedAmountAed}" />
								</div>

								<label class="col-sm-2 col-form-label">Proportion Unencumbered</label>
								<div class="col-sm-4">
									<input type="number" class="form-control number-24-2" th:field="*{proportionUnencumbered}" />
								</div>
							</div>

							<div class="form-group row">
								<label class="col-sm-2 col-form-label">HQLA/ELAR Eligibility</label>
								<div class="col-sm-4">
									<select class="form-control" th:field="*{hqlaElarEligibility}">
										<option value="" disabled selected>-- Select --</option>
										<option value="HQLA">HQLA</option>
										<option value="ELAR">ELAR</option>
									</select>
								</div>

								<label class="col-sm-2 col-form-label">Liquidity Type</label>
								<div class="col-sm-4">
									<select class="form-control" th:field="*{liquidityType}">
										<option value="" disabled selected>-- Select --</option>
										<option value="1">1</option>
										<option value="2A">2A</option>
										<option value="2B">2B</option>
									</select>
								</div>
							</div>

							<div class="form-group row">
								<label class="col-sm-2 col-form-label">Sukuk Type</label>
								<div class="col-sm-4">
									<input type="text" class="form-control vchar-50" th:field="*{sukukType}" />
								</div>
							</div>

							<h4 class="section-header">IFRS Provision information (where applicable)</h4>
							<div class="form-group row">
								<label class="col-sm-2 col-form-label">TTC PD</label>
								<div class="col-sm-4">
									<input type="number" step="0.01" class="form-control number-24-2" th:field="*{ttcPd}" />
								</div>
								<label class="col-sm-2 col-form-label">PIT PD</label>
								<div class="col-sm-4">
									<input type="number" step="0.01" class="form-control number-24-2" th:field="*{pitPd}" />
								</div>
							</div>

							<div class="form-group row">


								<label class="col-sm-2 col-form-label">ECL 1Y</label>
								<div class="col-sm-4">
									<input type="number" step="0.01" class="form-control number-24-2" th:field="*{ecl1y}" />
								</div>
								<label class="col-sm-2 col-form-label">ECL Lifetime</label>
								<div class="col-sm-4">
									<input type="number" step="0.01" class="form-control number-24-2" th:field="*{eclLifetime}" />
								</div>
							</div>

							<div class="form-group row">


								<label class="col-sm-2 col-form-label">ECL Final</label>
								<div class="col-sm-4">
									<input type="number" step="0.01" class="form-control number-24-2" th:field="*{eclFinal}" />
								</div>
								<label class="col-sm-2 col-form-label">IFRS9 Staging</label>
								<div class="col-sm-4">
									<input type="text" class="form-control number-24-2" th:field="*{ifrs9Staging}" />
								</div>
							</div>
						</div>

						<div class="card-footer text-center"
							style="background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(8px); padding: 10px; border-top: 2px solid #ccc;">
							<button type="submit" class="custom-tab-btn" onclick="updateform(event)">Update</button>
							<a th:href="@{/Investment_Securities_Data}" class="custom-tab-btn">Cancel</a>
						</div>

					</div>
				</form>
			</div>

			<div class="modal fade" id="alert">
				<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
					<div class="modal-content">
						<div class="menu-title-header">
							<div class="modal-title" id="exampleModalLabel" style="text-align: center; color: white;">
								BANK OF
								BARODA</div>
						</div>
						<div class="modal-body" style="text-align: center">
							<p id="alertmsg"></p>
							<button type="button" class="custom-tab-btn" onclick="list()"
								data-dismiss="modal">Close</button>
						</div>
					</div>
				</div>
			</div>

			<div class="modal fade" id="alert1">
				<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
					<div class="modal-content">
						<div class="menu-title-header">
							<div class="modal-title" id="exampleModalLabel" style="text-align: center; color: white;">
								BANK OF
								BARODA</div>
						</div>
						<div class="modal-body" style="text-align: center">
							<p id="alertmsg1"></p>
							<button type="button" class="custom-tab-btn" onclick="trade()"
								data-dismiss="modal">Close</button>
						</div>
					</div>
				</div>
			</div>




			<!-- Loader Modal (Using your existing loader image) -->
			<div class="modal fade" id="loader" data-backdrop="static" data-keyboard="false">
				<div class="modal-dialog modal-dialog-centered">
					<div class="modal-content" style="background: transparent; border: none;">
						<div class="modal-body text-center">
							<img th:src="@{/images/loader.gif}" style="width: 150px; height: auto;" alt="Processing...">
						</div>
					</div>
				</div>
			</div>

			<!-- Custom Alert/Result Modal (Matches your existing style) -->
			<div class="modal fade" id="resultModal">
				<div class="modal-dialog modal-dialog-centered">
					<div class="modal-content">
						<!-- Your custom styled header -->
						<div class="menu-title-header">
							<div class="modal-title" id="resultModalLabel" style="text-align: center; color: white;">
								<!-- Title will be set by JavaScript -->
							</div>
						</div>
						<div class="modal-body" style="text-align: center; font-size: 1.1rem;">
							<p id="resultModalBody"></p>
							<!-- Your custom styled button -->
							<button type="button" class="custom-tab-btn" onclick="list()"
								data-dismiss="modal">OK</button>
						</div>
					</div>
				</div>
			</div>
</body>
<script>
	$(document).ready(function () {
		$('#usertable').DataTable({
			"paging": true,
			"pageLength": 10,
			"lengthChange": false,
			"searching": true,
			"ordering": true,
			"info": true,
			"autoWidth": false,
			"language": {
				"search": "Search:"
			}
		});
	});
</script>


<!-- Include this after your DataTable initialization script -->

<style>
	/* Remove top margin/padding from DataTables parent containers */
	#data {
		padding-top: 0 !important;
		margin-top: 0 !important;
	}

	.table-responsive {
		margin-top: 0 !important;
		padding-top: 0 !important;
	}

	/* Ensure DataTables filter (search box) doesn't have spacing above it */
	div.dataTables_filter {
		margin-top: 0 !important;
		padding-top: 0 !important;
	}

	/* FIX: Make search label and box inline */
	div.dataTables_filter label {
		display: flex !important;
		align-items: center;
		gap: 8px;
		white-space: nowrap;
	}

	/* Style pagination buttons */
	.dataTables_wrapper .dataTables_paginate .paginate_button {
		background-color: white;
		border: 1px solid rgb(0, 164, 166);
		color: rgb(0, 164, 166) !important;
		padding: 5px 10px;
		margin: 2px;
		border-radius: 6px;
		transition: 0.3s;
		font-weight: 600;
	}

	.dataTables_wrapper .dataTables_paginate .paginate_button.current,
	.dataTables_wrapper .dataTables_paginate .paginate_button:hover {
		background-color: rgb(0, 164, 166) !important;
		color: white !important;
	}

	/* Optional: Style the search input */
	.dataTables_filter input {
		border: 1px solid rgb(0, 164, 166);
		border-radius: 4px;
		padding: 4px 8px;
	}
	.no-spinner {
	  -moz-appearance: textfield;
	}
</style>


<script>
	function handleBankChange(select) {
		const selectedBank = select.value;

		if (!selectedBank) {
			$('#bankSymbol').val('');
			$('#conventionalIslamic').val('');
			$('#localForeign').val('');
			$('#cbuaeTiering').val('');
			return;
		}

		$.ajax({
			url: '/BCDRS/getBankDetails',  // This uses your existing method
			type: 'GET',
			data: {bankName: selectedBank},
			success: function (data) {
				$('#bankSymbol').val(data.bankSymbol || '');
				$('#conventionalIslamic').val(data.conventionalIslamic || '');
				$('#localForeign').val(data.localForeign || '');
				$('#cbuaeTiering').val(data.cbuaeTiering || '');
			},
			error: function (xhr, status, error) {
				console.error('AJAX Error:', error);
				alert('Failed to fetch bank details.');
			}
		});
	}
</script>

<script>
	document.addEventListener('DOMContentLoaded', function () {
		document.querySelectorAll('.amount-field').forEach(function (input) {
			input.addEventListener('blur', function () {
				if (this.value) {
					this.value = parseFloat(this.value).toFixed(2);
				}
			});
		});
	});
</script>

<script>
	function trade() {

		$('#alert1').modal('hide');
	}
</script>
<style>
  /* Chrome, Safari, Edge, Opera */
  input::-webkit-outer-spin-button,
  input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }

  /* Firefox */
  input[type=number] {
    -moz-appearance: textfield;
  }
</style>
<script>
document.addEventListener("DOMContentLoaded", function () {

  function showError(input, message) {
    // Remove any existing error to prevent duplicates
    clearError(input);

    const error = document.createElement("small");
    error.id = input.id + "-error";
    error.className = "text-danger d-block mt-1";
    error.innerText = message;

    // Insert error message right after the input element
    input.classList.add("is-invalid");
    input.parentNode.insertBefore(error, input.nextSibling);
  }

  function clearError(input) {
    const error = document.getElementById(input.id + "-error");
    if (error) {
      error.remove();
    }
    input.classList.remove("is-invalid");
  }

  // VARCHAR2 (vchar-<max>) fields
  document.querySelectorAll('input[class*="vchar-"]').forEach(input => {
    let max = null;
    input.classList.forEach(cls => {
      if (cls.startsWith("vchar-")) {
        const limit = parseInt(cls.split("-")[1]);
        if (!isNaN(limit)) max = limit;
      }
    });

    if (max !== null) {
      input.removeAttribute("maxlength"); // Let JS handle limit

      input.addEventListener("input", () => {
        if (input.value.length > max) {
          showError(input, `Max ${max} characters allowed`);
        } else {
          clearError(input);
        }
      });
    }
  });


  // NUMBER(p,s) fields
  document.querySelectorAll('[class*="number-"]').forEach(input => {
    const match = input.className.match(/number-(\d+)-(\d+)/);
    if (match) {
      const total = parseInt(match[1]);
      const decimal = parseInt(match[2]);

      input.addEventListener("input", () => {
        const val = input.value.trim();
        if (val === "") {
          clearError(input);
          return;
        }

        if (!/^-?\d*(\.\d*)?$/.test(val)) {
          showError(input, "Only numeric values allowed");
          return;
        }

        const [intPart, decPart = ""] = val.replace("-", "").split(".");
        const totalDigits = intPart.length + decPart.length;

        if (totalDigits > total) {
          showError(input, `Max ${total} digits allowed`);
        } else if (decPart.length > decimal) {
          showError(input, `Max ${decimal} digits after decimal`);
        } else {
          clearError(input);
        }
      });
    }
  });

});
</script>
</html>